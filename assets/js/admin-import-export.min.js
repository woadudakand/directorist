!function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e,i,r){return(i=function(e){var i=function(e){if("object"!=t(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(i)?i:i+""}(i))in e?Object.defineProperty(e,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[i]=r,e}jQuery(document).ready((function(t){var i=function(t){if(""==t)return{};for(var e={},i=0;i<t.length;++i){var r=t[i].split("=",2);1==r.length?e[r[0]]="":e[r[0]]=decodeURIComponent(r[1].replace(/\+/g," "))}return e}(window.location.search.substr(1).split("&"));t("body").on("change",".directorist_directory_type_in_import",(function(){var e,r,o;e=t(this).val(),r=i.file_id,o=i.delimiter,t.ajax({type:"post",url:directorist_admin.ajaxurl,data:{action:"directorist_update_csv_columns_to_listing_fields_table",directory_type:e,delimiter:o,directorist_nonce:directorist_admin.directorist_nonce,file_id:r},beforeSend:function(){t("#directorist-type-preloader").show()},success:function(e){e.error?console.log({response:e}):(t(".atbdp-importer-mapping-table").remove(),t(".directory_type_wrapper").after(e))},complete:function(){t("#directorist-type-preloader").hide()}})})),t("#atbdp_csv_step_two").on("submit",(function(i){i.preventDefault(),t(".atbdp-importer-mapping-table-wrapper").fadeOut(300),t(".directorist-importer__importing").fadeIn(300),t(this).parent(".csv-fields").fadeOut(300),t(".atbdp-mapping-step").removeClass("active").addClass("done"),t(".atbdp-progress-step").addClass("active"),t(".importer-details").html("1/".concat(t(this).data("total"))),t(".directorist-importer-length").css("width","10%"),t(".directorist-importer-progress").val(10);var r=t(".directorist-listings-importer-config-field"),o=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=new FormData;a.set("action","directorist_import_listings"),a.set("_position",i),a.set("_offset",n),a.set("directorist_nonce",directorist_admin.directorist_nonce),r.length&&r.each((function(e,i){var r=t(i).attr("name"),o=t(i).val();a.append(r,o)}));var s=null;t("select.atbdp_map_to").length&&(s=t("select.atbdp_map_to")),t("input.atbdp_map_to").length&&(s=t("input.atbdp_map_to"));var c=t("#directory_type").val();if(c&&a.append("directory_type",c),s){var p=[];s.each((function(){var i=t(this).attr("name"),r=t(this).val();["listing_status","listing_title","listing_content","listing_img","directory_type"].includes(r)?(a.append(r,i),p.push(e({},r,i))):["category","location","tag"].includes(r)?(a.append("tax_input[".concat(r,"]"),i),p.push(e({},"tax_input[".concat(r,"]"),i))):""!=r&&(a.append("meta[".concat(r,"]"),i),p.push(e({},"meta[".concat(r,"]"),i)))}))}t.ajax({method:"POST",processData:!1,contentType:!1,url:directorist_admin.ajaxurl,data:a,success:function(e){if(e.error)console.log({response:e});else{var i=e.position/e.total*100;t(".importer-details").html("".concat(Math.min(e.position,e.total),"/").concat(e.total)),t(".directorist-importer-length").css("width",i+"%"),t(".directorist-importer-progress").val(i),console.log(e.logs.join("\n")),e.done?window.location=e.redirect_url:o(e.position,e.offset)}},error:function(t){window.console.log(t)}})};o()})),t("#upload").change((function(e){var i=e.target.files[0].name;t(".csv-upload .file-name").html(i)}))}))}();